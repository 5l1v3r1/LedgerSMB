<?lsmb INCLUDE 'ui-header.html' include_stylesheet = ['UI/Reports/pnl.css'];
account_data = report.account_data;

FORMATS = LIST_FORMATS();
LINK = request.script _ '?' _ ENVARS.QUERY_STRING _ '&amp;company=' _ DBNAME;
LINK = LINK.replace('\&amp;\&amp;', '&amp;');

USE String;

?>
<body class="financial-statement <?lsmb dojo_theme ?>">
<h1><?lsmb name ?></h1>
<h2><?lsmb text('Accounting period: [_1] to [_2]', report.from_date, report.to_date); ?></h2>
<!-- ###TODO-REPORT-HEADINGS: add back the descriptions of the comparisons -->
<table class="income_statement">
<tbody>
    <tr class="sectionhead">
        <th><?lsmb text('Account') ?></th>
<?lsmb FOREACH col IN report.cheads.ids.keys -?>
        <th><?lsmb report.cheads.ids.$col.props.description ?></th>
<?lsmb END -?>
    </tr>
<?lsmb FOREACH row IN report.sorted_row_ids ?>
<tr>
  <th><?lsmb nbsp = String.new("&nbsp;"); nbsp.repeat(report.rheads.ids.$row.path.size); -?>
<?lsmb report.rheads.ids.$row.props.account_number _ ' - ' _
         report.rheads.ids.$row.props.account_description ?></th>
<?lsmb FOREACH col IN report.cheads.ids.keys -?>
  <!-- ###TODO-REPORT-HEADINGS: implement sign conversion A/L/Q*contra -->
  <!-- ###TODO-REPORT-HEADINGS: add links on the cells to 'drill downs' -->
  <td class="amount"><?lsmb report.cells.$row.$col ?></td><?lsmb END ?>
</tr>
<?lsmb END ?>
<?lsmb IF FORMATS.grep('PDF').size() ?>
<tr><td><a href="<?lsmb LINK ?>&amp;format=PDF">[<?lsmb text('PDF') ?>]</a></td>
<td><a href="<?lsmb LINK ?>&amp;format=CSV">[<?lsmb text('CSV') ?>]</a></td>
<?lsmb END ?>
</tbody>
</table>
</body>
</html>

